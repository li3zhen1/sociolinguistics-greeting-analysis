<head>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.25.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.22.2"></script>
    <script>
        let raw = {
            "1960": {
                "regex\u4f60\u597d": 0.7818181818,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.0,
                "regex\u4f60\u597d\u5417": 0.1818181818,
                "regex\u5403\u4e86\u5417": 0.0363636364
            },
            "1970": {
                "regex\u4f60\u597d": 0.7184466019,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.0485436893,
                "regex\u4f60\u597d\u5417": 0.2330097087,
                "regex\u5403\u4e86\u5417": 0.0
            },
            "1980": {
                "regex\u4f60\u597d": 0.7794117647,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.0931372549,
                "regex\u4f60\u597d\u5417": 0.1225490196,
                "regex\u5403\u4e86\u5417": 0.0049019608
            },
            "1990": {
                "regex\u4f60\u597d": 0.7874251497,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.0508982036,
                "regex\u4f60\u597d\u5417": 0.1467065868,
                "regex\u5403\u4e86\u5417": 0.0149700599
            },
            "2000": {
                "regex\u4f60\u597d": 0.7605633803,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.1338028169,
                "regex\u4f60\u597d\u5417": 0.0845070423,
                "regex\u5403\u4e86\u5417": 0.0211267606
            },
            "2010": {
                "regex\u4f60\u597d": 0.8241106719,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.1146245059,
                "regex\u4f60\u597d\u5417": 0.0553359684,
                "regex\u5403\u4e86\u5417": 0.0059288538
            },
            "2020": {
                "regex\u4f60\u597d": 0.8509803922,
                "regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d": 0.0784313725,
                "regex\u4f60\u597d\u5417": 0.0666666667,
                "regex\u5403\u4e86\u5417": 0.0039215686
            }
        }
        Object.keys(raw).forEach(
            it => raw[it] = {
                "Non-question (你|您)好[啊]?": raw[it]["regex\u4f60\u597d"],
                "Non-question (上午|下午|晚上|中午|早上)好[啊]?": raw[it]["regex\u4e0a\u5348\u4e0b\u5348\u665a\u4e0a\u4e2d\u5348\u65e9\u4e0a\u597d"],
                "Question (你|您)(最近)?好[吗么没嘛啊]": raw[it]["regex\u4f60\u597d\u5417"],
                "Question 吃[过]?[饭]?了[吗么没嘛啊]": raw[it]["regex\u5403\u4e86\u5417"]
            }
        )
        let data = raw;

        let transformedData = [];

        for (const year in data) {
            for (const regex in data[year]) {
                transformedData.push({
                    year: year,
                    regex: regex,
                    value: data[year][regex]
                });
            }
        }

        const spec = {
            $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
            description: 'Stacked Area Chart',
            data: {
                values: transformedData
            },
            width: 360,
            height: 150,
            mark: 'area',
            encoding: {
                x: {
                    field: 'year',
                    type: 'ordinal',
                    axis: {
                        title: 'Year',
                        labelAngle: -45
                    }
                },
                y: {
                    field: 'value',
                    type: 'quantitative',
                    axis: {
                        title: 'Value',
                        format: "~%"
                    },
                    sort: ["Non-question (你|您)好[啊]?", "Non-question (上午|下午|晚上|中午|早上)好[啊]?", "Question (你|您)(最近)?好[吗么没嘛啊]", "Question 吃[过]?[饭]?了[吗么没嘛啊]"]
                },
                color: {
                    field: 'regex',
                    type: 'nominal',
                    legend: { title: 'Greetings' },
                    scale: {
                        domain: ["Non-question (你|您)好[啊]?", "Non-question (上午|下午|晚上|中午|早上)好[啊]?", "Question (你|您)(最近)?好[吗么没嘛啊]", "Question 吃[过]?[饭]?了[吗么没嘛啊]"],
                        range: ["#42a5f5", "#0277bd", "#ff7043", "#c62828"], // Custom colors,

                    }
                }
            }
        };

    </script>

</head>

<body>


    <div id="vis"></div>

    <script>
        vegaEmbed('#vis', spec);
    </script>
</body>